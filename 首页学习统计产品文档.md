# 首页学习统计产品文档

> 目标：在首页提供“概览 + 趋势 + 快捷行动”的学习统计，快速洞察当前学习状态与节奏，并引导进入复习/巩固。与学习中心的列表/复习入口形成差异化（学习中心偏“清单与复习入口”，首页偏“概览与趋势”）。

## 1. 功能范围
- **节奏指标**：连续学习天数、近7天活跃天数（避免与学习中心的状态分布重复）。
- **趋势**：近7天学习次数（补零）。
- **快捷行动**：继续学习（今日复习池），去巩固（薄弱池）。

**设计原则**：
- 不重复学习中心已有的状态分布（已掌握、薄弱词条等）。
- 不展示没有真实数据来源的指标（如本周进度目标）。
- 聚焦“学习节奏 + 趋势 + 快捷行动”。

## 2. 数据定义（后端 /home/statistics）
响应模型 `HomeStatisticsResponse`：
- today_review_count：今日需要复习数量
- mastered_count：已掌握数量
- needs_review_count：需巩固数量（70-89分）
- needs_improve_count：需改进数量
- not_mastered_count：未掌握数量
- total_cards_count：全部词条数量
- streak_days：连续学习天数（从今天起向前连续有学习记录的天数）
- active_days_7d：近7天活跃天数（有学习记录的天数）
- week_completed：本周完成的学习次数（学习记录数，周一为起点）
- week_target：本周学习目标次数（当前固定 30，可后续配置）
- trend_7d：近7天学习趋势数组，每项 {date: YYYY-MM-DD, count: 学习次数}

计算逻辑（server.py）：
- 状态分布：基于 `flash_cards.status` 汇总（MASTERED/NEEDS_REVIEW/NEEDS_IMPROVE/NOT_MASTERED）。
- 今日需复习：按状态与复习间隔（未掌握4h、需改进3天、需巩固1天、已掌握7天）判定。
- 学习记录：`learning_records` 近30天汇总，映射到 day->count。
- trend_7d：从今天向前7天补零生成。
- active_days_7d：trend_7d 中 count>0 的天数。
- streak_days：从今天起向前逐日，只要当日 count>0 即累计，否则中断。
- week_completed：周起点=周一，统计本周的学习记录数。
- week_target：临时固定 30（后续可做用户配置）。

## 3. 前端展示（首页）
位置：在“今日需要复习”卡片下方，上移到笔记列表之前；笔记列表可保留为入口/折叠。

组成：
1) **连续学习指标卡片**（全宽）
   - 主值：连续学习 streak_days 天
   - 副标题：保持学习习惯
   - 图标：火焰图标（🔥）
   - 颜色：红色系（#FF6B6B）

2) **近7天活跃指标卡片**（全宽，紧跟其后）
   - 主值：active_days_7d 天
   - 副标题：最近一周学习天数
   - 图标：日历/勾选（🗓️/✅）
   - 颜色：主色（紫/蓝）

3) **近7天趋势图**
   - 小柱状图，展示 trend_7d 学习次数；空数据时显示0高条。
   - 标题：近7天学习趋势；说明：学习次数。
   - 高度：约96px，日期展示月日（MM-DD）。

4) **快捷按钮**（双按钮横向布局）
   - 继续学习：跳转闪词滑动，今日复习池（已实现）
   - 去巩固：跳转学习中心 tab（弱项池）

样式要点：
- 指标卡片圆角16，浅阴影/描边，全宽显示。
- 趋势图高度约96px，柱状图最大高度60px，避免溢出。
- 按钮使用主色（紫/蓝）和描边样式。

空态与容错：
- 无数据时显示“暂无数据，开始学习吧”或数值0。
- trend 为空时补零数组。
- streak_days 为 0 时显示“0天”，active_days_7d 为 0 时显示“近7天活跃 0 天”。

## 4. 交互与跳转
- 继续学习：直接进入费曼滑动（今日复习词池）。
- 去巩固：进入学习中心（薄弱词条列表/筛选）。
- 趋势卡可后续扩展点击跳“成就/统计详情”，当前为静态展示。

## 5. 与学习中心的差异
- 首页统计：强调“概览 + 趋势 + 快捷行动”，不做列表。
- 学习中心：保留按状态/按笔记的列表与学习入口，属于“复习工作台”。

## 6. 设计决策说明

### 6.1 为什么移除“已掌握/薄弱词条”？
- 学习中心已有完整的状态分布展示（需巩固、需改进、未掌握、已掌握）。
- 首页避免重复，聚焦“节奏+趋势”而非“状态分布”。

### 6.2 为什么移除“本周进度”？
- 当前 `week_target` 是硬编码的固定值（30），没有真实数据来源。
- 用户无法设置目标，展示进度意义不大。
- 未来如有用户设置目标功能，可再添加回来。

### 6.3 为什么只保留“连续学习”？
- 连续学习天数是有效的节奏指标，能激励用户保持学习习惯。
- 近7天活跃天数补充了短期活跃度信息。
- 这两个指标都有真实数据来源，且不与学习中心重复。

## 7. 待扩展（未来）
- 用户可设置学习目标（周/月），恢复“本周进度”展示。
- 趋势维度支持“学习时长/掌握数/新掌握数”切换。
- 成就与徽章聚合到成就 Tab，首页仅保留数据概览。
- 可考虑添加“本周学习词条数”（不需要目标，直接展示数量）。

