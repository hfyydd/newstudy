---
trigger: manual
---
# Flutter 项目代码生成规则

## 项目概述
这是一个使用 Flutter 框架和 GetX 状态管理的移动应用项目。

## 代码规范要求

### 1. 架构模式
- **状态管理**: 必须使用 GetX 进行状态管理
- **目录结构**: 遵循现有的分层架构
- **依赖注入**: 使用 GetX 的依赖注入系统

### 2. 代码风格
- **Dart 版本**: 使用 Dart 3.4.0+ 语法特性
- **空安全**: 必须启用空安全
- **常量优先**: 优先使用 `const` 构造函数
- **类型注解**: 显式声明所有变量和函数返回类型

### 3. 命名约定
- **文件命名**: 使用蛇形命名法（snake_case），如 `home_controller.dart`
- **类命名**: 使用帕斯卡命名法（PascalCase），如 `HomeController`
- **变量命名**: 使用驼峰命名法（camelCase），如 `selectedTerm`
- **常量命名**: 使用全大写蛇形命名法，如 `DEFAULT_CATEGORY`

## 项目结构约束

### 目录组织
```
lib/
├── app/           # 应用配置
├── config/        # 配置文件
├── models/        # 数据模型
├── pages/         # 页面组件
│   └── {page_name}/
│       ├── {page_name}_controller.dart  # 控制器
│       ├── {page_name}_page.dart        # 页面组件
│       └── {page_name}_state.dart       # 状态管理
├── routes/        # 路由配置
└── services/      # 服务层
```

### 页面组件组织规则
- 每个页面必须有一个独立的文件夹，文件夹名使用蛇形命名法
- 页面文件夹必须包含以下文件：
  - `{page_name}_controller.dart` - 控制器，继承 `GetxController`
  - `{page_name}_page.dart` - 页面组件，使用 `StatelessWidget` 或 `StatefulWidget`
  - `{page_name}_state.dart` - 状态管理类，定义页面状态和响应式变量
- 控制器负责业务逻辑处理
- 页面组件负责UI渲染
- 状态文件负责数据状态管理

### 页面组件规则
- 页面组件必须是 `StatelessWidget` 或 `StatefulWidget`
- 使用 `GetView<Controller>` 简化控制器访问
- 遵循 Material Design 设计规范

## API 集成规范

### HTTP 服务
- 使用 Dio 进行网络请求
- 错误处理必须统一
- 响应数据必须进行类型转换

### 模型定义
- 每个 API 响应必须有对应的模型类
- 模型类必须实现 `fromJson` 工厂方法
- 必须包含数据验证逻辑

## UI/UX 规范

### 响应式设计
- 支持多种屏幕尺寸
- 使用 `MediaQuery` 进行响应式布局
- 确保在 iOS 和 Android 上表现一致

## 测试要求

### 单元测试
- 为所有控制器编写单元测试
- 测试覆盖率不低于 80%
- 使用 `flutter_test` 包

### Widget 测试
- 为重要组件编写 Widget 测试
- 测试用户交互流程
- 验证 UI 状态变化

## 代码质量

### 静态分析
- 遵循 `analysis_options.yaml` 中的规则
- 使用 `flutter_lints` 包
- 代码必须通过静态分析检查

### 性能优化
- 避免不必要的重建
- 使用 `const` 构造函数
- 合理使用 `Obx` 和 `GetBuilder`

## 安全最佳实践

### 数据安全
- 敏感信息不硬编码在代码中
- 使用环境变量管理配置
- API 密钥必须安全存储

### 输入验证
- 所有用户输入必须验证
- 防止 SQL 注入和 XSS 攻击
- 使用参数化查询

## 部署要求

### 构建配置
- 支持多环境构建（开发、测试、生产）
- 配置不同的 API 端点
- 优化构建产物大小

### 平台适配
- 支持 iOS、Android、Web、macOS、Windows、Linux
- 遵循各平台的设计规范
- 处理平台特定的功能

## 代码生成提示

### 当生成新功能时
1. 首先检查是否已有类似实现
2. 遵循现有的代码模式和命名约定
3. 确保与现有代码风格一致
4. 添加必要的注释和文档

### 当修改现有代码时
1. 理解现有代码的逻辑
2. 保持向后兼容性
3. 更新相关的测试用例
4. 验证修改不会破坏现有功能

## 错误处理指南

### 网络错误
- 显示友好的错误信息
- 提供重试机制
- 记录错误日志

### 数据错误
- 验证数据完整性
- 提供默认值或回退方案
- 优雅处理空数据

## 性能监控

### 关键指标
- 页面加载时间
- 内存使用情况
- 网络请求性能

### 优化建议
- 使用性能分析工具
- 定期进行性能测试
- 优化图片和资源加载

---

**最后更新**: 2025年1月
**适用版本**: Flutter 3.4.0+, Dart 3.4.0+

> 注意：所有生成的代码必须符合上述规则，确保代码质量和可维护性。